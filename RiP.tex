\documentclass[a4paper,10pt]{article}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%       FRONT MATTER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Explicit Bianchi $p$-adic $L$-functions and pseudo-nullity conjectures for fine Selmer groups}
\author{Marc Masdeu, Bharathwaj Palvannan and Chris Williams}
\date{}
\pagestyle{headings}






\usepackage{enumitem}


\let\OLDthebibliography\thebibliography
\renewcommand\thebibliography[1]{
\OLDthebibliography{#1}
\setlength{\parskip}{0pt}
\setlength{\itemsep}{0pt plus 0.3ex}
}


%Preamble
\usepackage[margin=1.1in]{geometry}
\usepackage{preamble}
%\ProvidesPackage{preamble-ams}
%\usepackage{preamble-ams}
\usepackage{xypic}

\usepackage{etoolbox}
\newtoggle{notes}
\toggletrue{notes}
%\togglefalse{notes} 
\usepackage{comment}
\usepackage{verbatim}
\iftoggle{notes}{
%% INCLUDE NOTES

\newcommand{\CWnote}[1]{
 \begin{color}{red}
 \marginpar{$\spadesuit$} #1
  --- Chris
 \end{color}
}
\newcommand{\thoughts}[1]{
#1
}
}{


\newcommand{\CWnote}[1]{

}
\newcommand{\thoughts}[1]{
}
}


\usepackage{fancyhdr}

%Heading Title
\lhead{\emph{Explicit Bianchi $p$-adic $L$-functions \& pseudo-nullity}}
\rhead{\emph{Masdeu, Palvannan \& Williams}}


\newcommand{\lb}{\\[8pt]}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                                                                MACROS
% 
%                          (To make sure we agree the same notation everywhere and can change it easily)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\fl}{\mathfrak{l}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\q}{\mathfrak{q}}
\newcommand{\pibar}{\overline{\pi}}

\newcommand{\unitsize}{\#\roi_K^\times}
\newcommand{\roihat}{\widehat{\roi}}
\newcommand{\FQ}{_{K/\Q}}



\newcommand{\Tbc}{T_{\mathrm{bc}}}


%Rigid spaces
\newcommand{\W}{\mathcal{W}}
\newcommand{\Wfull}{\mathscr{W}}

\newcommand{\WW}{\mathcal{W}}
\newcommand{\E}{\mathcal{E}}
\newcommand{\CC}{\mathcal{C}}

\newcommand{\cyc}{{\mathrm{cyc}}}

\newcommand{\Dz}{\mathcal{D}^0}
\newcommand{\Dl}{\mathscr{D}^0}
\newcommand{\Dla}{\mathcal{D}}
\newcommand{\DD}{\mathscr{D}}
\newcommand{\VV}{\mathscr{V}}

\newcommand{\rigidA}{\mathcal{A}^0}
\newcommand{\laA}{\mathcal{A}}

%Cohomology
\newcommand{\hc}{\h^1_{\mathrm{c}}}
\newcommand{\ssh}{^{\leq h}}
\newcommand{\Y}{Y_1(\n)}

%Localisations
\newcommand{\locx}{_{\m_x}}
\newcommand{\locl}{_{\m_\lambda}}


\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\Gal}{Gal}

\newcommand{\mel}{\mathrm{Mel}}


\newcommand{\Epar}{\E_{\mathrm{par}}}
\newcommand{\Ref}{\mathrm{ref}}
\newcommand{\bc}{\mathrm{bc}}

  \DeclareFontFamily{U}{wncy}{}
    \DeclareFontShape{U}{wncy}{m}{n}{<->wncyr10}{}
    \DeclareSymbolFont{mcy}{U}{wncy}{m}{n}
\DeclareMathSymbol{\Sha}{\mathord}{mcy}{"58}

\numberwithin{equation}{section}


\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                   TITLE AND ABSTRACT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\maketitle


\abstract{Let $\f$ be a cuspidal eigenform of weight 2 over an imaginary quadratic field $K$. In this paper, we explicitly compute $p$-adic $L$-functions attached to $\f$, using an algorithm via overconvergent cohomology. As an application, we provide evidence for a conjecture of Coates and Sujatha, which predicts the pseudo-nullity of the fine Selmer group of a rational elliptic curve over $K$.}

Things we need to add:
\begin{enumerate}
    \item Sketch of sharp/flat construction
    \item description of how to get the classical class/citation of Marc's papers
    \item More detail on the pseudo-nullity conjecture
    \item snake lemma trick motivation
    \item description of resultant calculations to show coprimality
    \item Evidence!!!
\end{enumerate}
\section{Introduction}

Many standard conjectures in Iwasawa theory predict that ``pseudo-null'' modules are ubiquitous. However,  the evidence for these conjectures, computational or otherwise, is limited. In this paper, we provide some of the first computational evidence for a pseudo-nullity conjecture of John Coates and Sujatha Ramdorai. Our main tool for doing this is an explicit algorithm for constructing $p$-adic $L$-functions attached to modular forms over imaginary quadratic fields, which -- combined with a particular case of the Iwasawa main conjectures -- allows further study of the structure of the Selmer group of the conjecture.


\subsection{The pseudo-nullity conjecture}
We state the conjecture in question. Let $K$ denote an imaginary quadratic field, and let $K_\infty$ denote the compositum of the $\Z_p$-extensions of $K$. Let $p$ be a rational prime that splits in $K$, and let $E/\Q$ be an elliptic curve with good supersingular reduction at $p$. The conjecture relates a Selmer group attached to the base-change $E/K$. Let $S$ denote the set of primes of $K$ dividing the conductor of $E/K$ and the discriminant of the imaginary quadratic field $K$. Let $K_S$ denote the maximal extension of $K$ unramified outside $S$. The fine Selmer group, denoted $\Sha^1(E[p^\infty],K_\infty)$, is defined by

\begin{align*}
\Sha^1(E[p^\infty],K_\infty) := \ker\bigg(H^1\left(\Gal{K_S}{K_\infty},E[p^\infty]\right) \longrightarrow \prod_{\nu \in S} \prod_{\eta \mid \nu} H^1\left(G_\eta, E[p^\infty]\right) \bigg).
\end{align*}
Here, $G_\eta$ denotes the decomposition group for the prime $\eta$ inside the Galois group $\Gal{K_S}{K_\infty}$. 

\CWnote{INSERT SOME ARITHMETIC SIGNIFICANCE OF THIS SELMER GROUP}

The Pontryagin dual of the fine Selmer group, denoted $\Sha^1(E[p^\infty],K_\infty)^\vee$, turns out to be a finitely generated module over the Iwasawa algebra $\Z_p[[\Gal{K_\infty}{K}]]$, which is (non-canonically) isomorphic to the unique factorization domain $\Z_p[[x_1,x_2]]$.

This project is motivated by the following conjecture of John Coates and Sujatha Ramdorai, which is named ``Conjecture B'' in~\cite{MR2148798}.

\begin{conjecture*}\label{coates-sujatha-fine}
  The $\Z_p[[x_1,x_2]]$-module $\Sha^1(E[p^\infty],K_\infty)^\vee$ is pseudo-null. That is, there exist two elements
  \[
    \theta_1, \theta_2\in \mathrm{Ann}_{\Z_p[[x_1,x_2]]}\left(\Sha^1(E[p^\infty],K_\infty)^\vee\right)
  \]
  such that they have no irreducible factor in common.
\end{conjecture*}

%Here, $\mathrm{Ann}_{\Z_p[[x_1,x_2]]}\left(\Sha^1(E[p^\infty],K_\infty)^\vee\right)$ denotes the annihilator of the $\Z_p[[x_1,x_2]]$-module $\Sha^1(E[p^\infty],K_\infty)^\vee$.

We study this conjecture through the prism of $p$-adic $L$-functions. In \cite{Loe14}, Loeffler attached four $p$-adic $L$-functions $L_p^{\pm,\pm}$ to $E/K$, which can be viewed \CWnote{Sharp/Flat construction} as elements in the ring $\Z_p[[x_1,x_2]]$. It is expected, if one believes one of the divisibilities of an appropriate Iwasawa Main Conjecture, that $L_p^{\pm,\pm}$ belongs to $\mathrm{Ann}_{\Z_p[[x_1,x_2]]}\left(\Sha^1(E[p^\infty],K_\infty)^\vee\right)$; assuming this, it would thus be possible to verify the conjecture by numerically computing two of these $p$-adic $L$-functions and checking that they are coprime in the this annihilator. 

\subsection{Explicit Bianchi $p$-adic $L$-functions}
To compute the $p$-adic $L$-functions of \cite{Loe14}, there is an algorithm of the third author. The main result of \cite{Wil17} was a construction of a $p$-adic $L$-function attached to very general classes of Bianchi modular forms -- that is, modular forms over $K$ -- using a generalisation of Stevens' theory of \emph{overconvergent modular symbols}.  A particular feature of this approach, as explored for classical modular forms in \cite{PS11}, is its amenability to computation.

To $E/\Q$, one can attach a classical modular form $f$ under modularity, and through base-change this corresponds to a Bianchi modular form $\f$. By assumption, this will have level $N\cO_F$ prime to $p$, but for each prime $\pri|p$, there are two $\pri$-stabilisations to level $\pri N\cO_F$, and hence four $p$-stabilisations to level $pN\cO_F$. The four $p$-adic $L$-functions attached to these stabilisations in \cite{Wil17} are precisely those of \cite{Loe14}. We give a sketch of the explicit construction in \S\ref{sec:bianchi p-adic l-functions}.

We actually use a modified version of the construction of \cite{Wil17}. Existing code is much more developed for computations with arithmetic group cohomology, rather than modular symbols, so we develop a cohomological version of the construction. This approach, however, introduces new theoretical complications, which we explain and treat in the main text. In particular, it requires explicitly inverting the natural map from modular symbols to group cohomology.

\subsection*{Acknowledgements}
 This research was supported through the programme "Research in Pairs" by the Mathematisches Forschungsinstitut Oberwolfach in 2018. We are grateful to the MFO for providing such a stimulating place to do research. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Bianchi modular forms and \texorpdfstring{$p$}{p}-adic \texorpdfstring{$L$}{L}-functions}
\label{sec:bianchi p-adic l-functions}
Let $K$ be an imaginary quadratic field, which we take to have class number 1 for simplicity (in line with our later computations). Let $\mathcal{O}_K$ be the ring of integers. For each congruence subgroup $\Gamma \subset \SLt(\mathcal{O}_K),$ there is a finite-dimensional $\C$-vector space $S_{2}^K(\Gamma)$ of `weight 2 Bianchi cusp forms', defined as harmonic vector-valued functions
\[
    \f = (\f_0,\f_1,\f_2) : \uhs \longrightarrow \C^3
\]
 on the upper half-space $\uhs := \C\times\R_{>0}$ satisfying a suitable transformation property under an action of $\Gamma.$ Such objects are a natural generalisation of classical modular forms; see \cite[\S1]{Wil17} for a more detailed exposition (noting that $S_2^K(\Gamma)$ for us is denoted $S_{0,0}(\Gamma)$ \emph{op.\ cit}.). 
 
 There is a Hecke action indexed by ideals of $\mathcal{O}_K$, \CWnote{Explicit Hecke operators!} and to an eigenform $\f \in S_2^K(\Gamma)$ one can define an $L$-function $L(\f,s)$ as the Dirichlet series whose coefficients are the Hecke eigenvalues (see \cite[\S1.2]{Wil17}). 

Of particular importance to us is the existence of a \emph{base-change} map. Let $E/\Q$ be an elliptic curve of conductor $N$ corresponding to a newform $f \in S_2(\Gamma_0(N))$ under modularity. We can consider $E$ instead to have coefficients over $K$. As predicted by Langlands, there exists a Bianchi newform $f/K$, the \emph{base-change of $f$ to $K$}, whose $L$-function is equal to $L(E/K,s)$. We have $f/K \in S_2^K(\Gamma_0(\n))$, where $\Gamma_0(\n) \subset \SLt(\mathcal{O}_K)$ is the subgroup of matrices that are upper-triangular mod $\n$, and where $\n|N\mathcal{O}_K$ is the conductor of $E/K$. (Note that if $N$ is coprime to the discriminant of $K/Q$, we have $\n = N\mathcal{O}_K$). The Hecke eigenvalues of $f/K$ can be described simply in terms of those of $f$ (see e.g.\ \cite[\S7.2]{BW18}). Note that
\[
    L(f/K,s) = L(E/K,s) = L(E/\Q,s)L(E/\Q,\chi_K,s) =  L(f,s)L(f,\chi_K,s),
\]
where $\chi_K$ is the quadratic Hecke character whose kernel cuts out $K/\Q$.

\subsection{Bianchi modular symbols}
The space $S_2^K(\Gamma)$ admits a simple description in terms of \emph{modular symbols}, which we now describe. Let 
\[
    \Delta_0 \defeq \mathrm{Div}^0(\Proj(K))
\]
denote the space of `paths between cusps' in $\uhs$, and let $V$ be any right $\SLt(K)$-module. Fix an ideal $\n$ and let $\Gamma := \Gamma_0(\n) \subset\SLt(K)$. We define the space of \emph{$V$-valued modular symbols for $\Gamma$} to be the space
\[
    \symb_{\Gamma}(V) \defeq \mathrm{Hom}_\Gamma(\Delta_0,V)
\]
of functions satisfying the $\Gamma$-invariance property that
\[(\phi|\gamma)(\delta)\defeq \phi(\gamma \delta)|\gamma = \phi(\delta)\hspace{12pt} \forall \delta\in\Delta_0, \gamma\in\Gamma,\]
where $\Gamma$ acts on the cusps by $\smallmatrd{a}{b}{c}{d}\cdot r = (ar+b)/(cr+d).$ 

Now let $\f \in S_2^K(\Gamma)$. To $\f$ one may attach an explicit differential form $\delta_{\f}$ on $\uhs$ as follows: let $(z,t)$ be a co-ordinate on $\uhs$, and note that $dz, d\overline{z}, dt$ span the $\C$-valued 1-forms on $\uhs$. Then define
\[
    \delta_{\f} := \f_0(z,t)dz - \f_1(z,t)dt - \f_2(z,t)d\overline{z} \in \Omega^1(\uhs).
\]
For $r,s \in \Proj(K),$ the map
\begin{align*}
    \phi_{\f} : \Delta_0 &\longrightarrow \C,\\
    \{r\to s\} &\longmapsto \int_{r}^s \delta_f,
\end{align*}
is well-defined and the transformation property satisfied by $\f$ ensures it is $\Gamma$-invariant, thus giving an element $\phi_f \in \Symb_\Gamma(\C).$ 

The space $\Symb_\Gamma(\C)$ admits an action of the Hecke operators, indexed by ideals of $\cO_F$ and generated by the operators $T_{\fl}$ for $\fl\nmid\n$ prime and $U_{\fl}$ for $\fl|\n$. 

\begin{proposition}
 The resulting map 
    \[
        \iota : S_2^K(\Gamma) \longrightarrow \Symb_\Gamma(\C)
    \]
    is injective and induces a splitting
    \[
        \symb_\Gamma(\C) \cong S_2^K(\Gamma) \oplus \mathrm{Eis}_2^K(\Gamma).
    \]
    For a prime $\fl\nmid \n$ of norm $\ell$, the Hecke operator $T_{\fl}$ acts on $\mathrm{Eis}_2^K(\Gamma)$ as multiplication by $\ell+1$.
\end{proposition}
\begin{proof}
    See, for example, \cite{Wil17} for the injection. For part (ii), observe that by \cite[Lemma 8.2]{BW17} we have a Hecke-equivariant isomorphism
    \[
        \symb_\Gamma(\C) \cong \mathrm{H}^1_{\mathrm{c}}(Y_\Gamma, \C),
    \]
    where $Y_\Gamma := \Gamma\backslash\uhs$, and the compactly supported cohomology admits a well-understood splitting $\mathrm{H}^1_{\mathrm{cusp}}(Y_\Gamma,\C) \oplus \mathrm{Eis}_\Gamma(\C)$ (see \cite[\S3.2.5]{Har87}). Moreover, under the injection $\iota$, the space $S_2^K(\Gamma)$ is mapped isomorphically onto $\mathrm{H}^1_{\mathrm{cusp}}(Y_\Gamma,\C)$. The other direct summand corresponds to Bianchi Eisenstein series, giving the claimed action of Hecke operators.
\end{proof}

Now let $\f \in S_2^K(\Gamma)$ be an eigenform, and let $\phi_{\f} \in \symb_\Gamma(\C)$ denote the associated modular symbol. For $p$-adic interpolation, we require algebraic coefficients. By \cite[\S8]{Hid94}, there exists a complex period $\Omega_{\f} \in \C^\times$ and a finite extension $L/\Qp$ such that we may consider $\phi_{\f}/\Omega_{\f} \in \symb_{\Gamma}(L)$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     Ovcvgt modular symbols
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Overconvergent modular symbols}
We briefly recap the main ideas in the construction of \cite{Wil17}. Overconvergent modular symbols provide a $p$-adic interpolation of the space of `classical' modular symbols. For such an interpolation to exist, it is crucial to pass to a level subgroup $\Gamma \subset \Gamma_0(p\cO_F).$ If $(p)|\n$, then $\Gamma_0(\n) \subset \Gamma_0(p\cO_F)$ already; if not, then it is necessary to `$p$-stabilise' to ensure this condition holds (see \cite[\S2.4]{BW18}). We now assume $\Gamma \subset \Gamma_0(p\cO_F)$ without further comment.

We pass to an (infinite-dimensional) coefficient module; namely, let $L/\Qp$ be a finite extension, let $\A_2(L)$ denote the space of convergent power series on $\Zp^2$, and let
\[
    \D_2(L) := \mathrm{Hom}_{\mathrm{cts}}(\A_2(L),L),
\]
the space of \emph{$p$-adic analytic distributions on $\Zp^2$.} Since $\Gamma \subset \Gamma_0(p),$ the left action of $\Gamma$ on $\A_2(L)$ by
\[
    \smallmatrd{a}{b}{c}{d} \cdot g(x,y) = g\left(\tfrac{b+dx}{a+cx}, \tfrac{\overline{b} + \overline{d}y}{\overline{a}+\overline{c}y}\right),
\]
is well-defined and induces dually a right action on $\D_2(L).$ The space of \emph{overconvergent modular symbols} is $\symb_{\Gamma}(\D_2(L)).$

Dualising the inclusion of $L$ into $\A_2(L)$ gives a surjection $\D_2(L) \rightarrow L$ of $\Gamma$-modules, and hence a (Hecke-equivariant) map
\[
    \rho : \symb_\Gamma(\D_2) \rightarrow \symb_\Gamma(L).
\]
Whilst this map will have a huge kernel, crucially, the Hecke action allows us to control it.

\begin{theorem}\emph{\cite[Thm.~6.10]{Wil17}} \label{thm:control theorem}
Let $\f \in S_2^K(\Gamma)$ be an eigenform, with $U_{\pri}\f = a_{\pri}\f$ for each $\pri|p$. If $v_{\pri}(a_{\pri}) < 1$ for all $\pri$, then the restriction of $\rho$ to the $\f$-eigenspaces of the Hecke operators is an isomorphism.
\end{theorem}

We say that $\f$ satisfying this condition have \emph{small slope}. If $\f$ is such a form, then the theorem says that there is a \emph{unique} $\psi_{\f} \in \symb_\Gamma(\D_2(L))$ lifting $\phi_{\f}/\Omega_{\f}.$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     p-adic L-function
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The $p$-adic $L$-function of a Bianchi modular form}\label{padic lfunction section}
Let $\f$ be a non-critical Bianchi modular form of level $U_1(\n)$ and weight $\lambda = (k,k)$, where $(p)|\n$, and let $\Psi_{\f} \in \hc(\Y,\DD_{\lambda}(L))\ssh$ be the associated overconvergent class.  
\begin{definition} 
Define the \emph{$p$-adic $L$-function of $\f$} to be the Mellin transform $L_p(\f,*) \defeq \mel(\Psi_{\f})$.
\end{definition}
We describe the interpolation property satisfied by $L_p(\f,*)$. Given an algebraic Hecke character $\varphi$ of $K$ whose conductor divides $(p^\infty)$, there is a natural associated character $\varphi_{p-\mathrm{fin}}$ of $\cl_K(p^\infty)$ associated to $\varphi$ (see \cite[\S7.3]{Wil17}). The main theorem of \cite{Wil17} is the following (Theorem 7.4 \emph{op.\ cit}.):
\begin{theorem}\label{thm:Wil17}
For any Hecke character $\varphi$ of $K$ of conductor $\ff|(p^\infty)$ and infinity type $0 \leq (q,r) \leq (k,k)$, we have
\[L_p(\f,\varphi_{p-\mathrm{fin}}) = \left(\prod_{\pri|p}Z_{\pri}(\varphi)\right)A(\f,\varphi)\Lambda(\f,\varphi),\]
for
\[ 
A(\f,\varphi) \defeq  \left[\frac{\varphi(x_{\ff})d\widetilde{\tau}(\varphi^{-1})\unitsize}{(-1)^{k+q+r}2\varphi_{\ff}(x_{\ff})\alpha_{\ff}\Omega_{\f}}\right],
\]
where $x_{\ff}$ is an explicit idele representing $\ff$, $\varphi_{\ff}$ is the restriction of $\varphi$ to $\prod_{v|\ff}K_v^\times$, $\widetilde{\tau}(\varphi^{-1})$ is a Gauss sum, $\alpha_{\ff}$ is the eigenvalue of $\f$ at $\ff$ and
\[Z_{\pri}(\varphi) \defeq \left\{\begin{array}{cl}1-\alpha_{\pri}^{-1}\psi(\pri)^{-1} &: \pri\nmid \ff,\\
1 &: \text{otherwise}.\end{array}\right.
\]
Writing $h_{\pri} = v_{\pri}(\alpha_{\pri})$, the distribution $L_p(\f,*)$ is $(h_{\pri})_{\pri|p}$-admissible in the sense of \cite[Defns. 5.10,6.14]{Wil17}. When $\ff$ has small slope, this ensures it is unique with this interpolation property. 
\end{theorem}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Computing \texorpdfstring{$p$}{p}-adic \texorpdfstring{$L$}{L}-series from modular symbols}
In this section, we show how to compute the $p$-adic $L$-series of a Bianchi modular form from its $p$-adic $L$-function (as a distribution on $\cl_K(p^\infty)$). Since we are working in the case where $p$ is split, this essentially just the product of two copies of the theory for classical modular forms, as found in \cite[\S9]{PS11}, and which we first briefly recall.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Recap of the classical theory}

For simplicity, we assume that $p \geq 3$, though the case $p = 2$ can be obtained with very little (and completely standard) modification. Let $\Phi \in \Symb_\Gamma(\D)$ be an overconvergent cohomology class for $\GLt/\Q$. We have a decomposition $\Zp^\times = (\Z/p\Z)^\times \times (1+p\Zp)$, and we denote projection to the first and second factors by $z \mapsto \{z\}$ and $z \mapsto \langle z\rangle$ respectively. 

We can identify distributions $\mu$ on $\Zp^\times$ with analytic functions on \emph{weight space} $\W = \mathrm{Hom}_{\mathrm{cts}}(\Zp^\times, \C_p^\times)$, which -- as a rigid space -- is $p-1$ copies of the open unit disc. Given an element $\phi$ in weight space, we can write $\phi$ as $\{\phi\}\langle\phi\rangle$, where $\{\phi\}$ is a homomorphism $(\Z/p\Z)^\times \rightarrow \Cp^\times,$ and the disc in $\W$ in which $\phi$ lives is completely determined by $\{\phi\}$. To $\mu = \Phi\{0\rightarrow\infty\}|_{\Zp^\times}$, then, we attach a collection of $p-1$ analytic functions on the open unit disc, one for each character of $(\Z/p\Z)^\times$. Each of these functions has a power series representation, which is what we compute.

Now fix a character $\psi$ on $(\Z/p\Z)^\times$, corresponding to some fixed disc in $\W$. Let $T$ be a parameter on this open unit disc.  The part of the (analytic) function attached to $\mu$ defined over this disc is defined as
\[
	L_p(\mu, \psi, T) \defeq \int_{\Zp^\times} \psi(z)(T+1)^{\log_{\gamma}(\langle z\rangle)} d\mu(z),
\]
 where $\gamma=p+1$. (Of course, for $z \in 1 + p\Zp$, we have $\log_\gamma(z) = \log_p(z) / \log_p(\gamma)$). Writing $z = \{z\}\langle z\rangle$ and expanding the log, we obtain the power series representation $L_p(\mu,\psi,T) = \sum_{n\geq 0} d_n(\psi)T^n$, where $d_n(\psi)$ is defined as
\[
  d_n=\sum_{j\geq 0} c_j^{(n)} \sum_{a=0}^{p-1}\psi(a) \{a\}^{-j} \int_{a+p\Z_p} (z-\{a\})^j d\Phi\{0\to\infty\}.
\]
Here, $c_j^{(n)}$ is defined by from the equation
\[
  \binom{\log_{\gamma}(z+1)}{n} = \sum_{j\geq 0} c_j^{(n)} z^j,
  \]
For further details, see \cite[\S9]{PS11}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The Bianchi case}
Now we turn to the Bianchi case. Let $\Phi$ now be an element of $\Symb_{\Gamma}(\D_2)$. As outlined above, the $p$-adic $L$-function is most naturally a distribution $\mu$ on $\cl_K(p^\infty)$, which -- since we are assuming class number one for simplicity -- we identify with $(\roi_K\otimes_{\Z}\Zp)^\times/\roi_K^\times \cong (\Zp^\times \times \Zp^\times)/\roi_K^\times$. Evaluating $\Phi$ at $\{0\rightarrow\infty\}$, we obtain a distribution on all of $\roi_K\otimes_{\Z} \Zp$, and we pass to the $p$-adic $L$-function by restricting to functions with support on the units that are invariant under the global units. In this sense, we will identify $\mu$ with $\Phi\{0\rightarrow\infty\}$.

One can consider the direct analogue of the weight space above, that is, considering continuous homomorphisms $\Zp^\times \times \Zp^\times \rightarrow \Cp^\times$, and show that this decomposes as the disjoint union of $(p-1)^2$ products of open unit discs, parametrised by characters of $(\roi_K/p)^\times = (\Z/p)^\times \times (\Z/p)^\times$. By directly generalising the approach above, given a measure $\mu$ on $(\roi_K\otimes_{\Z}\Zp)^\times$ and such a character $\psi$, one can define an associated (two-variable) analytic function $L_p(\mu,\psi,T_1,T_2)$ on the corresponding product of open discs. Because the $p$-adic $L$-function actually lives on $\cl_K(p^\infty)$ rather than $(\roi_K\otimes_{\Z}\Zp)^\times$, such a function only has meaning (in relation to $p$-adic $L$-functions) when $\psi$ descends to the quotient $(\roi_K/p)^\times/\roi_K^\times$.

Fix such a character $\psi$. Writing $p\roi_K = \pri\pribar$, we see that $\psi = \psi_{\pri}\psi_{\pribar}$, where $\psi_{\pri}$ is the restriction to $(\roi_K/\pri)^\times$. We also have parameters $z_{\pri}, z_{\pribar}$ on $\cl_K(p^\infty)$, and $T_{\pri}, T_{\pribar}$ on the product of open discs. Using the same arguments as above, we find the following.

\begin{proposition}
The $p$-adic $L$-series attached to $\psi$ and $\mu$ is
\[
	L_p(\mu,\psi,T_{\pri},T_{\pribar}) = \sum_{m\geq 0}\sum_{n\geq 0} d_{m,n}(\psi) T_{\pri}^mT_{\pribar}^n,
\]
where
\begin{align*} 
    d_{m,n}(\psi) = \sum_{i\geq 1} \sum_{j\geq 1} c_i^{(m)} c_j^{(n)} \bigg[\sum_{(a=0}
^{p-1}\sum_{b=0}^{p-1} \psi_{\pri}\big(a\big) &\psi_{\pribar}\big(b\big) \{a\}^{-i} \{b\}^{-j} \\
\times &\int_{(a+p\Zp) \times (b+p\Zp)} \big(z_{\pri}-\{a\}\big)^i \big(z_{\pribar}-\{b\}\big)^j d\mu(\mathbf{z}) \bigg].
\end{align*}
\end{proposition}
Note here that we've identified distributions on $\cl_K(p^\infty)$ with distributions on $(\roi_K\otimes_{\Z}\Zp)^\times$ invariant under the action of $\roi_K^\times$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Obtaining power series from the moments of \texorpdfstring{$\mu$}{mu}}
In the setting of modular symbols, there is a simple strategy to compute the values of the distribution arising in the definition of $d_{m,n}$. Write $U_{a,b}$ for the open compact set $(a+p\Zp)\times(b+p\Zp) \subset (\roi_K\otimes_{\Z}\Zp)^\times$. We compute that
\begin{align*}
	\int_{U_{a,b}}f(z_{\pri},z_{\pribar}) d\mu(\mathbf{z}) &\defeq \Phi\{0\rightarrow\infty\}(f(z_{\pri},z_{\pribar})\mathbbm{1}_{U_{a,b}}) \\
    &= \lambda_{(p)}^{-1}\Phi\{c/p \rightarrow \infty\}\big(f(c + pz_{\pri}, \overline{c} + pz_{\pribar})\big),
    \end{align*}
where $c = c_{a,b} \in \roi_K$ is such that
\[
	c \equiv a \pmod{\pri},\quad \overline{c}\equiv b\pmod{\pribar}.
\]
To see this, one applies the operator $\lambda_p^{-1}U_{p\roi_K} = \lambda_p^{-1}U_{\pri}U_{\pribar}$, which acts as the identity on $\Phi$, and note that the indicator function kills all but the $a$ term of $U_{\pri}$ and the $b$ term of $U_{\pribar}$, corresponding to the $c$ term of $U_p$; see \cite[\S7.1]{Wil17} for more details. Since in this calculation $f$ is a polynomial function, it is simple to compute this value by taking a linear combination of the moments of $\Phi\{c/p\rightarrow \infty\}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Twists}
The theory for twists by finite order characters is simple. For characters of conductor dividing $(p^\infty)$, this is essentially built into the original definition, so consider a finite order character $\chi$ of conductor $(\mathfrak{d}) = \mathfrak{D} \subset \roi_K$ prime to $p$. From $\Phi$, one defines a twisted symbol
\[
	\Phi_\chi \defeq \sum_{b \newmod{\mathfrak{D}}} \chi(b) \bigg[\matrd{\mathfrak{d}}{b}{0}{1}\cdot\Phi\{b/\mathfrak{d} \rightarrow \infty\}\bigg],
\]
then computes $L_p(\mu,\psi\chi,T) \defeq L_p(\mu_\chi,\psi,T),$ where $\mu_\chi \defeq \Phi_\chi\{0\rightarrow \infty\}|_{\cl_K(p^\infty)}$. This case is treated in \cite[\S3.4]{BW17}.










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Rephrasing via arithmetic cohomology}
The above gives a complete algorithm for constructing $p$-adic $L$-series from Bianchi modular symbols. For practical reasons, however, this space would be slow to compute, and it is better to work instead with the arithmetic cohomology groups $\h^1(\Gamma,\D_2)$, for which extensive implementation already exists. Such an approach might also generalise more naturally to different settings, where modular symbols themselves do not exist.

\subsection{Definition and basic properties}
See Marc's papers (which one explains it best, Marc?), or  \cite{PP09}; include things such as $U_p$ operators.



\subsection{Computing \texorpdfstring{$p$}{p}-adic \texorpdfstring{$L$}{L}-series from cohomology}

One downside of computing with arithmetic cohomology, rather than modular symbols, is that we are not free to evaluate at the same range of divisors. Directly from the definition, we have a map
\begin{align*}
	\delta : \symb_{\Gamma}(\D_2) &\longrightarrow \h^1(\Gamma,\D_2)\\
    \Phi &\longmapsto \big(\varphi: \gamma \mapsto \Phi\{\gamma\cdot\infty \rightarrow \infty\}\big).
\end{align*}
In particular, given $\varphi$, we can read off directly the values $\Phi\{r \to s\}$ \emph{only} for $r,s$ equivalent to the cusp $\infty$. This poses a problem for our algorithm, since we need to evaluate at pairs $\{a/p \to \infty\}$, where $a$ is coprime to $p$, and in general $a/p$ will \emph{not} give the same cusp as $\infty$. To obtain the information we need from $\varphi$, then, requires a careful study of the map $\delta$.

From the general theory, the kernel and cokernel of $\delta$ are Eisenstein; in particular, it is an isomorphism on the cuspidal part. It follows that there is a \emph{unique} cuspidal lift $\Phi$ of $\varphi$ under $\delta$. In the next section, we show how to explicitly invert $\delta$ to obtain this class $\Phi$ from $\varphi$, and thus how to obtain the $p$-adic $L$-function from $\varphi$.


%%===============================================================
%%		MOTIVATION

\subsection{Explicit inversion of $\delta$}

\subsubsection{Motivation}
In the next subsection, we give an explicit and computable recipe for inverting $\delta$ on cuspidal arithmetic cohomology classes. Before doing this, however, we give some motivation as to where this recipe comes from. 

The map $\delta$ can be realised in cohomology as 
\[
\delta : \h^0(\Gamma,\mathrm{Hom}(\Delta_0,\D_2) \longrightarrow \h^1(\Gamma,\D_2),
\]
and is the connecting map in a long exact sequence given by the snake lemma. In particular, for a right $\Gamma$-module $\mathcal{M}$, let:
\begin{itemize}
	\item $C^i(\mathcal{M}) \defeq C^i(\Gamma,M)$ = $\mathcal{M}$-valued $i$-cochains for $\Gamma$,
	\item $Z^i(\mathcal{M}) \defeq$ $\mathcal{M}$-valued $i$-cocycles for $\Gamma$,
	\item and $B^i(\mathcal{M}) \defeq$ $\mathcal{M}$-valued $i$-coboundaries for $\Gamma$. 
\end{itemize}
Explicitly, as we are using right modules, a 1-cocycle is a map $z : \Gamma \to \mathcal{M}$ such that $z(\gamma_1\gamma_2) = z(\gamma_1) + z(\gamma_2)|\gamma_1^{-1}$. Also write $(C^i/B^i)(\mathcal{M})$ for the $i$-cochains modulo the $i$-coboundaries.

Recall that $\Delta_0 = \mathrm{Div}^0(\Proj(F))$, and let $\Delta = \mathrm{Div}(\Proj(F)) = \Z[\Proj(F)]$. Now, the degree map gives a short exact sequence $0 \to \Delta_0 \to \Delta \to \Z \to 0$, and hence -- for any right $\Gamma$-module $M$ -- a short exact sequence
\[
	0 \to M \longrightarrow \Hom(\Delta,M) \longrightarrow \Hom(\Delta_0,M) \to 0,
\]
of $\Gamma$-modules, identifying $M \cong \Hom(\Z,M')$, and where $\Gamma$ act on $\Hom(\Delta,M')$ by $(\phi|\gamma)(D) = \phi(\gamma D)|\gamma$. This gives rise to a diagram
\[
	\xymatrix@C=10mm@R=4mm{
		& & & \h^0(\Gamma,\Hom(\Delta_0,M))\ar[d] &\\
			 & \frac{C^0}{B^0}\big(\Gamma,M\big)\ar[r]\ar[d]   & \frac{C^0}{B^0}\big(\Gamma,\Hom(\Delta,M)\big)\ar[r]\ar[d] &  \frac{C^0}{B^0}\big(\Gamma,\Hom(\Delta_0,M)\big)\ar[r]\ar[d] &0\\
	0 \ar[r]  & Z^1(\Gamma,M)  \ar[r]\ar[d] & Z^1(\Gamma,\Hom(\Delta,M))  \ar[r] & Z^1(\Gamma,\Hom(\Delta_0,M)) &\\
	& \h^1(\Gamma,M) & & & \\
}
\]
from which we obtain the snake exact sequence
\[
\cdots \to \h^0(\Gamma,\Hom(\Delta,M)) \xrightarrow{\alpha} \h^0(\gamma,\Hom(\Delta_0,M)) \xrightarrow{\delta} \h^1(\Gamma,M) \xrightarrow{\beta} \h^1(\Gamma,\Hom(\Delta,M)) \to \cdots.
\]
In proving that this is exact, one takes an element in $\ker(\beta)$ -- such as our class $\varphi$ -- and explicitly realises it in the image of $\delta$. Thus we can lift $\delta$ by pursuing this diagram chase.

In practice, we will work at the level of cocycles, and this will depend on choices made throughout the algorithm (whilst the corresponding cohomology classes, and the p-adic L-functions, will not). Suppose we are given a cohomology class $\varphi \in H^1(M)$ represented by a cocycle $\varphi_0$. 

\begin{proposition}
We have
\[
	\ker(\beta) = \ker\bigg(\h^1(\Gamma,M) \xrightarrow{\oplus_i \mathrm{res}_{c_i}} \h^1\big(\mathrm{Stab}_\Gamma(c_i),M)\bigg),
\]
where $c_i$ runs over a complete set of representatives for the cusps of $\Gamma$ in $\Proj(F)$.
\end{proposition}
\begin{proof}
	The map $\beta$ is induced by the map of cocycles that sends the cocycle $\varphi_0 : \Gamma \to M$ to
	\[
		\varphi_0 \longmapsto \bigg(\beta\left(\varphi_0\right) : \gamma \mapsto \left[c \mapsto \varphi_0(\gamma)\right]\bigg),
	\]
	where $c$ is any cusp (recalling that $\Delta = \Z[\Proj(F)]$ is freely generated by cusps). In particular, each $\gamma \in \Gamma$ is just sent to a constant function in $\Hom(\Delta,M)$. For $\varphi \in \ker(\beta)$, we must have $\beta(\varphi_0)$ is a coboundary, and hence that there exists $v \in \Hom(\Delta,M)$ such that 
	\[
		\beta(\varphi_0)(\gamma) = v|\gamma^{-1} - v.
	\]
	In particular, we have 
	\[
		\beta(\varphi_0)(\gamma)(c) = v(\gamma^{-1} c)|\gamma^{-1} - v(c) = \varphi_0(\gamma)
	\]
	for all $c \in \Proj(F)$, by definition of $\beta(\varphi_0)$. For $c_i$ as above and $\gamma \in \mathrm{Stab}_\Gamma(c_i)$, we have
	\[
		\varphi_0(\gamma) = v(c_i)|\gamma^{-1} - v(c_i) = v_i|\gamma^{-1} - v_i,
	\]
	for $v-i \defeq v(c_i) \in M$. In other words, the restriction of $\varphi_0$ to $\mathrm{Stab}_\Gamma(c_i)$ is a coboundary, as required.
	
	For the converse, suppose $\varphi_0$ is in $\ker(\oplus \mathrm{res}_{c_i})$; then we have $v_i$ as above for each cusp representative $c_i$. But this is enough to reconstruct $v \in \Hom(\Delta,M)$ such that $\beta(\varphi_0) = v|\gamma^{-1} - v$, since every cusp is $\Gamma$-equivalent to one of the $c_i$. In particular, we can define
	\[
		v(r) = v(\gamma_r c_{i(r)}) = COMPLETE THIS
	\]
\end{proof}
		

%%===============================================================
%%		ALGORITHM

\subsubsection{Algorithm for inverting $\delta$}
Summarising the above, we arrive at the following recipe for inverting $\delta$. Let $\varphi \in \h^1(\Gamma,\D_2)$ be a lift of a cuspidal classical eigenclass. In particular, it will be parabolic, and for each cusp $r \in \Proj(F)$, it will vanish under the restriction maps $\mathrm{Res}_r : \h^1(\Gamma,\D_2) \to \h^1(\mathrm{Stab}_{\Gamma}(r),\D_2)$.
\begin{enumerate}
	\item Find representatives $c_1 = \infty, c_2, ..., c_t \in \Proj(F)$ of the cusps $\Gamma\backslash\Proj(F)$ of $\Gamma$.
	\item For each $r \in \Proj(\F)$, let $c_{i(r)}$ be the equivalent representative, and let $g_r \in \Gamma$ be such that in $\Proj(\Q)$, we have
	\[
			g_r \cdot r = c_{i(r)}.
	\]
	\item Explicitly represent $\mathrm{Res}_{c_i}(\varphi)$ as a coboundary in $\h^1(\mathrm{Stab}_{\Gamma}(c_i), \D_2)$. In particular, find $v_1, ..., v_t \in \D_2$ such that 
	\[
		\varphi(g) = v_i|g^{-1} - v_i
	\]
	for all $g \in \mathrm{Stab}_{\Gamma}(c_i).$ For this, we compute the action of $g$ as a linear operator on $\D_2$ up to some precision, and then solve the resulting linear system for a sufficiently large set of generators of the stabiliser\footnote{In practice, this is actually more subtle than it appears: in the linear system, the variables will appear with varying degrees of precision, due to the filtration appearing in the explicit lifting theorem.}.
	
	\item Now define
	\begin{align*}
		\widetilde{\Phi} : \Proj(\Q) &\longrightarrow \D_2,\\
				r = g_r^{-1}c_{i(r)} &\longmapsto \varphi(g_r)\big|g_r + v_{i(r)}\big|g_r,
	\end{align*}
	and $\Phi : \Delta_0 \longrightarrow \D_2$ by
	\[
		\Phi\{r\to s\} \defeq \widetilde{\Phi}(s) - \widetilde{\Phi}(r).
	\]
\end{enumerate}	
	
	
	\begin{proposition}
		The map $\Phi$ gives a well-defined element of $\Symb_{\Gamma}(\D_2)$ such that $\delta(\Phi) = \varphi$.
	\end{proposition}
	\begin{proof}
		The map $\Phi$ is linear in $r \to s$, since it is defined as the difference $\widetilde{\Phi}(s) - \widetilde{\Phi}(r)$. It is mapped to $\varphi$ under $\delta$; setting $r = \gamma\cdot\infty$ and $s = \infty$, we have $g_r = \gamma^{-1}$, $g_s = 1$, and $c_{i(r)} = c_{i(s)} = c_1$. Then by definition,
		\begin{align*}
			\delta(\Phi)(\gamma) \defeq \Phi\{\gamma\cdot\infty \to \infty\} &= \varphi(1)|1 + v_1 - \varphi(\gamma^{-1})|\gamma^{-1} - v_1|\gamma^{-1}\\
									&= \varphi(\gamma) + \left[v_1 - v_1|\gamma^{-1}\right],
		\end{align*}
		using that $\varphi(1) = 0 = \varphi(\gamma\gamma^{-1}) = \varphi(\gamma) + \varphi(\gamma^{-1})|\gamma^{-1}$. The term in the square brackets is a coboundary; thus the cocycle $\delta(\Phi)$ represents the same cohomology class as $\varphi$.
		
		It remains to show that $\Phi$ is $\Gamma$-equivariant. Let $\gamma \in \Gamma$. Note that if $g_r \cdot r = c_{i(r)}$, then $g_r\gamma^{-1} \cdot \gamma r = c_{i(r)}$, so that $c_{i(\gamma r)} = c_{i(r)}$ and $g_{\gamma r} = g_r\gamma^{-1}$. Then
		\begin{align*}
			\widetilde{\Phi}(\gamma r) &= \varphi(g_{\gamma r})|g_{\gamma r} + v_{i(\gamma r)}|g_{\gamma r}\\
					 &= \varphi(g_r \gamma^{-1})|g_r\gamma^{-1} + v_{i(r)}|g_r\gamma^{-1}\\
						&= \varphi(g_r)|g_r\gamma^{-1} + \varphi(\gamma^{-1})|g_r^{-1}g_r\gamma^{-1} + v_{i(r)}|g_r\gamma^{-1}\\
						&= \widetilde{\Phi}(r)|\gamma^{-1} + \varphi(\gamma^{-1})|\gamma^{-1}.
		\end{align*}
		The second term is independent of $r$, so cancels in the difference $\widetilde{\Phi}(s) - \widetilde{\Phi}(r)$. It follows that
		\[
			\Phi\{\gamma r \to \gamma s\}|\gamma = \widetilde{\Phi}(s)|\gamma - \widetilde{\Phi}(r)|\gamma = \Phi\{r\to s\},
		\]
		as required.
	\end{proof}

In general, the map $\Phi$ thus defined is not an eigensymbol. In particular, whilst there is a unique cuspidal lift $\Phi_{\mathrm{cusp}}$ of $\varphi$ under $\delta$, the map $\Phi$ can be any element of $\Phi_{\mathrm{cusp}} + \mathrm{ker}(\delta)$. However, we have:

\begin{proposition}
	For all sufficiently large primes $\mathfrak{l}$ of $K$, coprime to $p\n$, the symbol
	\[
		\Phi_{\f} \defeq \frac{T_{\mathfrak{l}} - \ell - 1}{a_{\mathfrak{l}} - \ell + 1} \Phi \in \Symb_\Gamma(\D_2)
	\] 
	is the uniquely determined overconvergent (cuspidal) eigensymbol mapped to $\varphi$ under $\delta$, where $\ell$ is the norm of $\mathfrak{l}$ and $a_{\mathfrak{l}}$ is the $T_{\mathfrak{l}}$-eigenvalue of the Bianchi modular form $\f$.
\end{proposition}
\begin{proof}
By the long exact sequence given by the snake lemma, the kernel of $\delta$ is given by the image of $\mathrm{Hom}_\Gamma(\Delta,\D_2)$ in $\Symb_\Gamma(\D_2)$, or, more precisely, the Eisenstein subspace. We know that for prime $\mathfrak{l}\nmid p\n$ of norm $\ell$, the Hecke operator $T_{\mathfrak{l}}$ acts on the Eisenstein subspace by $\ell + 1$ (see, for example, \cite[Rem.~5.2]{PS11} for this in the rational case; more generally, it can be obtained by studying $\mathrm{Hom}(\Delta,\D_2)$ as a Hecke-module). For sufficiently large $\mathfrak{l}$, the Hasse bound implies that $a_{\mathfrak{l}} \neq \ell + 1$. By the remarks above, the operator $T_{\mathfrak{l}} - \ell -1$ kills any Eisenstein contribution, and thus acts as a projector onto the cuspidal subspace. Now renormalising by $a_{\mathfrak{l}} - \ell - 1$ gives a cuspidal eigensymbol in $\delta^{-1}(\varphi)$. Such a symbol is unique by strong multiplicity one combined with Theorem \ref{thm:control theorem}.
\end{proof}
%Henceforth we shall simply renormalise and write $\Phi$ in place of $\Phi_{\mathrm{cusp}}$.


\begin{comment}
\subsection{old}



Let thus $\varphi$ be a cocycle representing a cohomology class $[\varphi]\in H^1(\Gamma,\D_2)$, and assume that its restriction to each cusp $c$ is trivial. Choose representatives $\infty=c_1,\ldots c_t\in \mathbb{P}^1(\Q)$ for the cusps of $\Gamma$, and set, for $\gamma_i,\gamma_j\in \Gamma$ and representatives $c_i$ and $c_j$,
\[
\Phi\{\gamma_j c_j\rightarrow \gamma_i c_i\} = \gamma_j\varphi(\gamma_j^{-1})-\gamma_i\varphi(\gamma_i^{-1}).
\]
\begin{proposition}
With the previous definition, we have:
\begin{enumerate}
    \item $\Phi$ is well defined.
    \item $\Phi\in \Symb_{\Gamma}(\D_2)$,
    \item $\delta(\Phi)=\varphi$.
\end{enumerate}
\end{proposition}
\begin{proof}
Suppose that we replace $\gamma_i$ with $\gamma_i'$ and $\gamma_j$ with $\gamma_j'$, in a way that
\[
\gamma_ic_i=\gamma_i'c_i,\quad \gamma_jc_j=\gamma_j'c_j.
\]
Then the difference between the corresponding $\varphi$ evaluations is
\[
\left(\gamma_j'\varphi((\gamma_j')^{-1})-\gamma_j\varphi(\gamma_j^{-1})\right) - \left(\gamma_i'\varphi((\gamma_i')^{-1})-\gamma_i\varphi(\gamma_i^{-1})\right),
\]
so it suffices to prove that
\[
\gamma_i\varphi(\gamma_i^{-1}) = \gamma_i'\varphi((\gamma_i')^{-1}).
\]
But remember that $\gamma_ic_i =\gamma_i'c_i$, which means that $\gamma_i'= \gamma_i g$, for some $g\in\operatorname{Stab}_{\Gamma}(c_i)$. In this case, we have
\[
\gamma_i g \varphi(g^{-1} \gamma_i^{-1}) - \gamma_i \varphi(\gamma_i^{-1}) = \gamma_i g \varphi(g^{-1}).
\]
We will show that $\varphi(g)=0$ for all $g\in\operatorname{Stab}_{\Gamma}(c_i)$. Since $\varphi$ is parabolic, we know there is a map $f\colon \mathbb{P}^1(\Q_p)\to \D_2$ such that $\varphi(g) = gf(g^{-1}P) - f(P)$ for all $P\in \mathbb{P}^1(\Q_p)$, and without loss of generality we may assume that $f(c_i)=0$. Therefore,
\[
\varphi(g)=gf(c_i)-f(c_i) = 0 -0=0.
\]

To prove the second claim, the definition clearly makes $\Phi$ to be linear on $\Div^0(\mathbb{P}^1(\Q))$, so it is enough to check $\Gamma$-equivariance. This follows from the following calculation:
\begin{align*}
\Phi\{g\gamma_jc_j\rightarrow g\gamma_ic_i\}&=\varphi(g\gamma_j)-\varphi(g\gamma_i) = 
g\gamma_j\varphi(\gamma_j^{-1}g^{-1}) - g\gamma_i\varphi(\gamma_i^{-1}g^{-1})\\
&=\left(g\gamma_j\varphi(\gamma_j^{-1}) + g\varphi(g^{-1})\right) -\left(g\gamma_i\varphi(\gamma_i^{-1}) + g\varphi(g^{-1})\right)\\
&= g\left(\gamma_j\varphi(\gamma_j^{-1}) - \gamma_i\varphi(\gamma_i^{-1})\right)\\
&=g\Phi\{\gamma_jc_j\rightarrow \gamma_ic_i\}.
\end{align*}

The third claim is obvious: since $\infty=c_1$, we have
\[
(\delta\Phi)(\gamma)=\Phi\{\infty\rightarrow\gamma\infty\} = \varphi(1)-\gamma\varphi(\gamma^{-1})-\varphi(1)=\varphi(\gamma).
\]
\end{proof}

The modular symbol thus defined is not an eigensymbol, in general. Since $\delta$ is Hecke-equivariant, we have:
\[
\delta(T(f) - f) = 0,
\]
and so $T(f) = f + \epsilon$, where $\epsilon$ is an Eistenstein symbol. In order to obtain an eigensymbol it suffices to apply for example $T_\ell-\ell-1$ for any prime $\ell$.
      
% The problem, however, is that it is difficult to make the inverse of $\delta$ explicit. In particular, given an overconvergent arithmetic class $\varphi$, from the definition we only know how to evaluate $\delta^{-1}(\varphi)$ at divisors of the form $\gamma\cdot\infty \rightarrow \infty$, where $\gamma \in \Gamma$. The cusps $0$ and $\infty$, however, are not $\Gamma$-equivalent, so it is far from clear how to extract the data $\delta^{-1}(\varphi)\{0\rightarrow\infty\}$ from $\varphi$. For clarity, we first explain how to do this for $\GLt/\Q$, which is similar but simpler.
\end{comment}


\subsubsection{The rational setting}
Throughout this subsection we take $\Gamma_0(Np) \subset \mathrm{SL}_2(\Z)$, with $N$ square-free prime to $p$, and work with a rational overconvergent eigensymbol $\Phi \in \Symb_{\Gamma_0(Np)}(\D)$. The $\Gamma_0(Np)$ orbit of $\infty$ is precisely the set of rationals $b/c$, where $b$ and $c$ are coprime and $Np|c$. We wish, then, to compute integrals of the form
\[
 \int_{a+p\Zp}z^j d\Phi\{0\rightarrow\infty\} = \Phi\{0\rightarrow\infty\}(z^j\mathbf{1}_{a+p\Zp}(z)),
\]
for $a \in \{1,...,p-1\}$ and $j \geq 0$, in terms of the distributions $\Phi\{b/Np\rightarrow\infty\}$ (for $b$ prime to $Np$).

\begin{proposition} Let $a_p$ denote the $U_p$-eigenvalue of $\Phi$.
\begin{itemize}
\item[(i)] Suppose $N = 1$. Then
\[
\Phi\{0\rightarrow\infty\}(z^j \mathbf{1}_{a+p\Zp}(z)) = a_p^{-1}\Phi\{a/p \rightarrow \infty\}\bigg((a+pz)^j\bigg).
\]
\item[(ii)] Suppose $N = q$ is prime. Let $d_q$ denote the order of $q$ in $(\Z/p\Z)^\times$, and write $a_q$ for the $U_q$-eigenvalue of $\Phi$. Then we have
\begin{align*}
\big(a_q -a_q^{1-d_q}&q^{d_qj}\big)\Phi\{0\rightarrow\infty\}(z^j \mathbf{1}_{a+p\Zp}(z)) =
\\
& a_p^{-1} \sum_{m = 0}^{d_q-1} a_q^{-m}q^{jm}%\lambda_1^{-m_1}q_1^{m_1j}\cdots \lambda_r^{-m_r}q_r^{m_rj} 
\sum_{\substack{\beta \in (\Z/Np\Z)^\times\\ \beta \equiv a/q^m\newmod{p}}} \Phi\{\beta/qp\rightarrow \infty\}\big((\beta + qpz)^j\big).
\end{align*}

\item[(iii)]Let $N = q_1\cdots q_r$, with each $q_i$ prime. For $1\leq i \leq r$, let $d_i$ denote the order of $q_i$ in $(\Z/p\Z)^\times$, and let $a_i$ denote the $U_{q_i}$-eigenvalue of $\Phi$. Then we have 
\begin{align*}
	\bigg[\prod_{i=1}^r\big(&a_i -a_i^{1-d_i}q_i^{d_ij}\big)\bigg]\Phi\{0\rightarrow\infty\}(z^j \mathbf{1}_{a+p\Zp}(z)) =
\\
&a_p^{-1} \sum_{m_1 = 0}^{d_1-1} \cdots \sum_{m_r = 1}^{d_r - 1} \bigg(\bigg[\prod_{i=1}^ra_i^{-m_i}q_i^{jm_i}\bigg]%\lambda_1^{-m_1}q_1^{m_1j}\cdots \lambda_r^{-m_r}q_r^{m_rj} 
\sum_{\substack{\beta \in (\Z/Np\Z)^\times\\ \beta \equiv a/\prod_iq_i^{m_i} \\\newmod{p}}} \Phi\{\beta/Np\rightarrow \infty\}\big((\beta + Npz)^j\big)\bigg).
\end{align*}
\end{itemize}
\end{proposition}

\begin{remark}
Before giving the proof, we note that if $j = 0$ and there is some $i$ such that $a_{i} = 1$ or $a_{i} = -1$ and $d_i$ is even, then the multiplying factor on the left-hand side of (iii) is zero. In any other case, we can simply divide through by this factor to obtain the required value. This leads us to the rather odd situation where we can compute all of the higher moments, but \emph{not} the zeroth moments; in other words, we can compute all of the `overconvergence', but not the original classical symbol. In certain cases, for example for the elliptic curve of conductor 55, none of the above exceptional cases occur and we can compute complete information.
\end{remark}

\begin{proof}
To prove (i), apply $a_p^{-1}U_p$, and note that 
\[
 \Phi\{b/p \rightarrow \infty\}((b+pz)^j\mathbf{1}_{a+p\Zp}(b+pz)) = 0
\]
if $b \neq a$. To prove (ii), we pursue a similar strategy. A single application of $U_q$ gives
\begin{align*}
 a_q\Phi\{0\rightarrow\infty\}(z^j\mathbf{1}(z)) = q^j&\Phi\{0\rightarrow\infty\}(z^j\mathbf{1}_{a+p\Zp}(qz)) \\
&+ \sum_{b = 1}^{q-1}\Phi\{b/q \rightarrow \infty\}\big((b+qz)^j\mathbf{1}_{a+p\Zp}(b+qz)\big).
\end{align*}
Every term in the sum involves $\Phi\{b/q\rightarrow \infty\}$ with $b$ coprime to $q$, which is moving towards what we ultimately require, and we have another $\Phi\{0\rightarrow\infty\}$ term that is very similar to the left-hand side. Now applying $a_q^{-1}U_q$ to this $\Phi\{0\rightarrow\infty\}$ term in the right hand side, we obtain 
\begin{align*}
 \Phi\{0\rightarrow\infty\}(z^j\mathbf{1}(z)) = a_q^{-1}q^{2j}&\Phi\{0\rightarrow\infty\}(z^j\mathbf{1}_{a+p\Zp}(q^2z)) \\
&+ a_q^{-1}q^j\sum_{b = 1}^{q-1}\Phi\{b/q \rightarrow \infty\}\big((b+qz)^j\mathbf{1}_{a+p\Zp}(q(b+qz))\big)\\
&+ \sum_{b = 1}^{q-1}\Phi\{b/q \rightarrow \infty\}\big((b+qz)^j\mathbf{1}_{a+p\Zp}(b+qz)\big).
\end{align*}
Continuing in this vein, after $d_q$ iterations we are left with a series of sums including $\Phi\{b/q\rightarrow\infty\}$, with $b$ coprime to $q$, and the term
\[
 a_q^{1-d_q}q^{d_qj}\Phi\{0\rightarrow\infty\}(z^j\mathbf{1}_{a+p\Zp}(q^{d_q}z)) = 
 a_q^{1-d_q}q^{d_qj}\Phi\{0\rightarrow\infty\}(z^j\mathbf{1}_{a+p\Zp}(z)).
\]
We can bring this over to the left-hand side and factor out the resulting factor of $(a_q - a_q^{1-d_q}q^{d_q})$ to obtain 
\begin{align}\label{eqn:almost there}
\Phi\{0\rightarrow\infty\}(z^j &\mathbf{1}_{a+p\Zp}(z)) =
\big(a_q -a_q^{1-d_q}q^{d_qj}\big)^{-1}\\\
&\times \sum_{m = 0}^{d_q-1} a_q^{-m}q^{jm}
\sum_{b=1}^\infty \Phi\{b/q\rightarrow \infty\}\big((b + qz)^j\mathbf{1}_{a+p\Zp}(q^{m}(b+qz))\big).
\end{align}
Now apply $a_p^{-1}U_p$. For each individual summand $\Phi\{b/q \rightarrow \infty\}((b+qz)^j\mathbf{1}_{a+p\Zp}(q^{m}(b+qz))$ in (\ref{eqn:almost there}), there is a unique $c_{b,m} \newmod{p}$ such that 
\[
 q^m(b + q(c_{b,m}+pz) \equiv a \newmod{p},
\]
namely, $c_{b,m} \equiv q^{-1}(a/q^m - b) \newmod{p}.$ On this summand, only the $c_{b,m}$ term of the $U_p$ operator survives, yielding the new summand
\[
 \Phi\left\{\frac{b+qc_{b,m}}{pq}\rightarrow\infty\right\}\big((b+qc_{b,m})^j\big)
\]
Writing $\beta = b+qc_{b,m}$. It remains to show:
\begin{claim}
As $b$ ranges over $\{1,...,q-1\},$ the values $b+qc_{b,m}$ range over elements of $(\Z/pq\Z)^\times$ congruent to $a/q^m \newmod{p}$.
\end{claim}
But it is clear that all the $b + qc_{b,m}$ are distinct modulo $q$, and by definition, each is congruent to $a/q^m \newmod{p}$. As both $\{b+qc_{b,m}\}$ and $\{\beta \in (\Z/pq\Z)^\times: \beta \equiv a/q^m \newmod{p}\}$ have $q-1$ members, they must be equal. This gives the claim and completes the proof of (ii).

To prove (iii), we work by induction on the number of primes, repeating exactly the arguments of above.
\end{proof}


\subsubsection{The Bianchi case}
We now return to the Bianchi case, letting $\n\subset \roi_K$ be a squarefree ideal prime to $(p)$, and $\Phi \in \Symb_{\Gamma_0(\n)}(\D_2)$ an overconvergent Bianchi eigensymbol. For each prime $\q|p\n$, write $a_{\q}$ for the $U_{\q}$-eigenvalue of $\Phi$, and write $\pi_{\q}$ for a fixed choice of generator of the ideal (recalling we restrict to $K$ of class number 1). Using very much the same techniques as in the rational case, we have the following.

\begin{proposition}
Write $\n = \q_1\cdots\q_r$ with each $\q_i$ prime. For $1 \leq i \leq r$, let $d_{i}$ denote the order of $\pi_{\q}$ in $(\roi_K/p\roi_K)^\times$. Also write $\pi_{\n} \defeq \pi_{\q_1}\cdots\pi_{\q_r}$, a generator of $\n$. Then 
\begin{align*}
	\bigg[\prod_{i=1}^r\big(a_{\q_i} - &a_{\q_i}^{1-d_i}\pi_{\q_i}^{d_ij}\pibar_{\q_i}^{d_ik}\big)\bigg]\Phi\{0\rightarrow\infty\}(x^jy^k \mathbf{1}_{a+p\Zp \times b+p\Zp}(x,y)) =
\\
&a_{(p)}^{-1} \sum_{m_1 = 0}^{d_1-1} \cdots \sum_{m_r = 1}^{d_r - 1} \bigg(\bigg[\prod_{i=1}^ra_{\q_i}^{-m_i}\pi_{\q_i}^{jm_i}\pibar_{\q_i}^{km_i}\bigg]\\%\lambda_1^{-m_1}q_1^{m_1j}\cdots \lambda_r^{-m_r}q_r^{m_rj} 
&\hspace{20pt}\times\sum_{\substack{\beta \in (\roi_K/p\n\roi_K)^\times\\ \beta \equiv a/\prod_i\pi_{\q_i}^{m_i} \newmod{\pri}\\
\overline{\beta} \equiv b/\prod_i\pibar_{\q_i}^{m_i} \newmod{\pribar}}} \Phi\{\beta/p\pi_{\n}\rightarrow \infty\}\big((\beta + p\pi_{\n}x)^j(\overline{\beta} + p\pibar_{\n})^k\big)\bigg).
\end{align*}

\end{proposition}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The algorithms}


\subsection{Computing with distributions}
Two variable distributions with coefficients in an extension $L/\Qp$ are naturally in bijection with doubly-indexed bounded sequences in $L$ (see \cite[Proposition 3.6]{Wil17}), the map being given by
\[
 \mu \mapsto \{\mu(x_iy_j) : i,j \geq 0\}. 
\]
We can compute with these distributions using the \emph{finite approximation modules} \emph{op.\ cit.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Computing the action of \texorpdfstring{$\Sigma_0(p)^2$}{S0(p)2} on distributions}

It is important to explicitly understand the action of $\Sigma_0(p)^2$ on these distributions. In particular, there are an increasing number of conventions regarding actions (both left and right) on distributions, and we wish to be as clear as possible about the ones we adopt.
\begin{definition}
Consider the usual basis $\{x^iy^j : i,j \geq 0\}$ of $\A(L)$, and order it first by total degree $i+j$ and then lexicographically in $j$ and then $i$. To make this explicit, we label these basis monomials by defining
\[
	v_{n,i} \defeq x^{n-i}y^{i},
 \]
which are then ordered $v_{0,0}, v_{1,0},v_{1,1},v_{2,0},v_{2,1},\dots$, corresponding to $1,x,y,x^2,xy,\dots$ .
\end{definition}
Recall that $\Sigma_0(p)^2$ acts on the \emph{left} of $\A(L)$ by
\[
	g \cdot f(x,y) = f\left(\frac{b+dx}{a+cx},\frac{\overline{b}+\overline{d}x}{\overline{a} + \overline{c}x}\right), \hspace{12pt} g = \left[\matrd{a}{b}{c}{d},\matrd{\overline{a}}{\overline{b}}{\overline{c}}{\overline{d}}\right].
\]
Denote by $\psi_{\A}(g)$ the matrix of $g$ acting on $\A(L)$ in the basis $
\{v_{n,i}\}$.

We want to compute the dual action on distributions. The natural dual action is a \emph{right} action. However, since we will ultimately compute with the group cohomology -- which prefers \emph{left} actions -- it is convenient here to pass to the right action on $\A_2(L)$ defined by $f|g = g^{-1}\cdot f,$ inducing a left dual action. 

Now write
\[
	v_{n,i}^* \defeq \mathcal{X}^{n-i}\mathcal{Y}^i
\]
for the dual basis, where $v_{n,i}^*(v_{m,j}) = \delta_{mn}\delta_{ij}.$ For , then the matrix of $g$ acting on $\D(L)$, on the \emph{left}, in this dual basis, is given by 
\[
	\psi_{\D}(g) \defeq \psi_{\A}(g^{-1})^T.
\]
We are reduced, then, to computing the action on $\A$.

In practice, we use the following algorithm. Define 
\[
	r = \frac{b+dx}{a+cx}, \hspace{12pt} s = \frac{\overline{b}+\overline{d}y}{\overline{a}+\overline{c}x}.
\]
We then start by considering $r^0s^0 = 1$. Suppose we have computed $r^{n-i}s^i$ for all $i \in \{0,...,n\}.$ The coefficients of $r^{n-i}s^i$ give the column (at $v_{n,i}$) of the matrix of $g$ acting on $\A$. We then compute at step $n+1$ by multiplying by $r$ or $s$ as necessary, computing up to the desired precision.


\subsection{An explicit lifting theorem}
Including commutative diagram relating arithmetic cohomology and modular symbols with the action of the $U_{\pri}, U_{\pribar}$ operators. (Not well-defined on cocycles in general).




\footnotesize
\renewcommand{\refname}{\normalsize References} 
\bibliography{references}{}
\bibliographystyle{alpha}

\Addresses

\end{document}

